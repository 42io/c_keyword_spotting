#!/bin/bash

set -e

cd "`dirname "${BASH_SOURCE[0]}"`"

mkdir -p ../../bin

gcc -Werror -Wall -Wextra -Wpedantic -Wno-sign-compare \
    -Dkiss_fft_scalar=double -Dc_speech_features_double \
    -I. -I../../lib/c_speech_features-0.4.8/ \
    -I../../lib/c_speech_features-0.4.8/kiss_fft130/ \
    ../../lib/c_speech_features-0.4.8/c_speech_features.c \
    ../../lib/c_speech_features-0.4.8/kiss_fft130/kiss_fft.c \
    ../../lib/c_speech_features-0.4.8/kiss_fft130/tools/kiss_fftr.c \
    -o ../../bin/fe main.c fe.c -lm

# python_speech_features/example.py
# from python_speech_features import mfcc
# from python_speech_features import delta
# from python_speech_features import logfbank
# import scipy.io.wavfile as wav

# (rate,sig) = wav.read("english.wav")
# mfcc_feat = mfcc(sig,rate)
# for a in mfcc_feat:
#   print ' '.join('%.3f' % x for x in a)

TEST="$(cat <<-EOF
5.770 -18.883 -2.058 -8.103 -1.355 -1.761 -10.679 -9.454 -16.337 -18.888 -16.811 -20.301 -0.173
5.895 -17.432 0.773 -4.844 -0.365 -4.981 -8.699 -3.792 -12.757 -16.653 -10.792 -12.212 -4.656
6.019 -19.224 -2.395 -10.201 0.017 -0.286 -2.795 -4.055 -13.353 -9.928 -6.096 -6.478 -8.434
6.140 -19.224 -5.531 -16.339 -2.384 7.127 0.066 -10.018 -13.881 -10.736 -6.152 -4.917 -16.214
6.154 -18.534 -5.446 -13.645 -1.618 8.855 7.344 -8.391 -15.342 -10.891 -4.573 0.057 -9.806
6.067 -18.730 -4.567 -13.793 -2.899 7.180 7.706 -7.931 -16.240 -10.759 -4.802 -6.713 -9.251
5.965 -16.332 -4.378 -15.017 -2.902 3.488 3.491 -8.745 -16.001 -4.882 9.495 4.278 -1.536
6.015 -16.446 -4.478 -18.565 -10.344 -2.025 -0.384 -10.668 -13.303 -0.640 11.006 5.089 -7.765
6.076 -16.762 -3.030 -18.733 -8.442 0.375 -1.741 -9.087 -14.895 -5.459 11.251 8.020 -6.208
9.120 -6.765 -4.216 7.012 -10.877 5.583 -5.811 -13.223 -1.884 -10.472 -0.712 9.670 4.593
15.100 0.758 -31.911 11.367 -45.963 -20.330 -28.983 -30.346 29.081 17.100 -10.399 17.615 47.470
17.475 8.607 -23.070 -4.659 -38.635 -25.262 -22.409 -26.678 10.622 13.749 -8.718 -14.922 -6.760
19.118 12.311 -30.738 4.105 -51.085 -2.169 -20.884 -19.363 13.910 -4.284 27.637 -25.456 -14.877
20.040 12.511 -33.875 -2.149 -44.564 5.018 -23.246 -13.143 17.700 8.174 22.436 -27.911 -14.855
20.395 5.731 -33.011 -0.007 -37.112 5.488 -4.065 -8.439 21.637 14.878 18.712 -22.710 -15.727
20.092 2.473 -28.622 -0.371 -33.553 0.943 -1.847 -7.271 16.646 2.819 10.297 -17.264 -22.106
19.584 -3.200 -29.541 -9.138 -25.716 -2.773 -4.864 -2.683 18.681 -7.143 -5.343 -22.409 -21.717
20.208 -0.229 -41.343 -7.384 -27.163 -11.855 11.897 -7.969 20.477 -19.285 -5.497 -9.457 -25.136
20.612 2.013 -45.709 -6.579 -22.262 -2.217 21.761 -7.786 29.465 -31.342 1.789 -8.001 -19.550
20.747 2.519 -39.326 -9.992 -20.722 3.752 15.591 -4.690 18.780 -22.252 -2.728 -7.264 -14.111
20.775 -0.278 -43.891 -11.309 -19.816 8.290 12.897 -1.464 29.536 -24.942 0.556 -8.900 -20.485
20.681 1.997 -44.580 -11.953 -21.786 6.265 6.316 -12.232 22.144 -32.922 4.682 -9.509 -12.520
20.400 7.371 -46.726 -0.793 -18.319 8.792 6.678 -16.644 32.630 -42.698 19.878 -18.044 -0.660
19.991 3.652 -37.513 -11.101 -14.957 3.537 0.570 -16.874 31.483 -31.856 13.605 -23.384 -7.835
19.644 3.746 -29.022 -9.415 -17.390 -7.922 -10.410 -16.700 35.108 -20.443 8.930 -15.918 -2.021
19.488 4.833 -25.758 -7.320 -21.644 -14.071 -14.825 -22.330 49.219 -21.728 18.752 -14.094 -0.693
19.232 8.711 -26.801 -11.610 -18.125 -17.097 -15.785 -29.374 58.519 -21.300 12.980 1.458 -9.235
18.299 7.328 -22.913 -5.157 -21.914 -25.274 -16.023 -36.404 59.639 -32.559 5.193 -4.733 -10.488
16.641 4.083 -13.068 -10.055 -20.276 -5.469 -10.885 -37.910 41.187 -19.165 -3.960 -4.588 -13.565
15.270 5.713 -25.551 -17.685 -21.313 -12.219 -12.490 -22.473 29.162 -27.697 -2.963 -11.030 -14.320
14.554 4.112 -25.115 -16.916 -15.713 -7.446 -17.807 -20.767 28.476 -24.749 -19.939 -6.886 -17.963
13.824 3.836 -21.330 -15.115 -16.106 -2.139 -11.925 -10.964 28.634 -18.931 -18.918 -7.179 -12.907
13.131 3.571 -20.956 -16.211 -8.990 2.638 -9.709 -8.742 20.292 -14.341 -21.018 -5.350 -14.491
12.639 1.271 -24.210 -18.869 0.395 4.164 -11.703 -1.646 12.120 -8.482 -14.234 -2.755 -19.047
13.093 7.531 -13.566 2.467 -4.894 9.894 -4.944 -3.671 10.504 -9.458 -8.095 1.309 -8.015
17.916 20.191 -11.126 -35.708 -49.271 6.052 -8.389 -24.139 39.328 -39.162 5.517 -0.397 -1.509
17.949 14.200 -15.014 -50.409 -64.661 -0.545 -21.433 -42.854 29.996 -44.704 -8.702 -11.140 -2.291
16.728 13.674 0.238 -27.616 -43.411 -4.217 -4.318 -14.809 32.289 -26.082 14.499 -2.121 0.871
16.259 -4.242 2.725 -33.658 -57.147 11.539 5.103 -41.537 49.392 -48.088 20.182 -11.704 -13.433
16.269 -3.997 2.028 -29.575 -56.618 8.675 5.322 -38.403 61.691 -50.385 23.754 -14.612 -16.870
15.827 7.540 18.780 0.529 -51.733 -9.782 -5.802 -23.025 27.697 -35.834 10.730 -2.545 -8.726
17.170 20.092 12.976 -15.966 -53.980 -26.675 -21.112 -23.550 17.016 -34.828 0.549 -9.275 -7.118
18.148 26.857 21.579 -7.990 -84.452 -22.487 10.642 -31.969 24.277 -31.473 -10.000 6.591 3.383
18.494 24.110 3.707 -6.203 -63.750 -19.415 -7.734 -25.524 21.243 -22.504 -10.314 7.497 0.247
18.495 26.757 4.288 0.882 -60.294 -2.126 1.723 -26.793 19.441 -23.160 -12.867 9.445 0.685
18.512 15.938 -0.408 -7.765 -48.316 -10.697 -2.480 -19.641 8.662 -19.164 -13.720 10.215 5.385
18.579 20.256 0.057 -2.685 -51.538 -9.165 10.069 -22.111 18.852 -13.438 -13.090 19.668 5.274
18.547 19.204 2.999 -4.362 -53.848 -4.397 7.898 -19.572 10.620 -18.126 -2.592 25.213 6.317
18.616 22.874 -11.821 4.442 -50.436 -21.427 6.519 -6.659 3.982 -40.046 14.108 35.447 -2.587
18.636 15.574 -7.709 -4.377 -38.584 -17.798 -3.602 -7.965 -4.575 -24.900 18.587 30.930 0.643
18.813 21.036 -15.457 4.230 -40.964 -17.794 -3.873 -10.039 -3.556 -31.150 27.791 37.945 -7.361
18.839 17.911 -17.967 -2.036 -38.590 -14.446 -8.471 -15.500 -0.272 -24.022 32.665 38.233 -8.474
18.722 19.485 -27.747 -4.525 -39.553 -18.063 -14.952 -25.342 4.605 -35.155 32.708 27.757 -20.924
18.449 21.722 -25.203 0.131 -26.406 -16.280 -14.504 -22.331 14.079 -24.416 36.163 30.877 -16.903
18.035 19.290 -26.677 -3.697 -14.172 -29.363 -19.691 -22.090 15.091 -7.127 32.710 20.275 -12.616
17.903 15.182 -24.761 -1.463 -21.964 -24.700 -29.008 -23.622 21.899 -15.646 20.283 12.825 -15.291
17.390 12.136 -31.451 -3.035 -22.468 -28.441 -29.684 -29.157 21.406 -26.455 13.778 9.256 -24.179
17.203 8.724 -22.565 -4.154 -13.350 -30.660 -18.514 -29.290 32.990 -27.734 20.438 6.936 -13.009
16.313 8.949 -20.433 -7.975 -1.440 -35.819 -17.146 -33.013 26.084 -10.856 14.184 -2.993 -1.568
17.226 9.806 -29.413 -6.545 -0.527 -42.957 -35.278 -41.647 33.018 -11.628 8.065 -11.634 -2.061
17.290 6.884 -26.572 -5.398 1.405 -38.571 -39.799 -27.316 23.150 -7.857 2.989 -12.363 -1.634
17.495 11.588 -24.799 1.134 14.781 -33.218 -39.478 -29.298 30.092 -4.157 3.375 -12.519 12.485
17.547 11.894 -28.215 -7.997 18.590 -43.266 -49.158 -34.024 25.708 -6.492 0.595 -11.352 13.773
17.543 11.081 -20.447 -3.402 25.559 -39.803 -57.995 -39.567 30.251 2.741 0.354 -14.973 10.208
16.783 11.537 -18.669 -7.377 26.356 -41.135 -52.168 -36.774 26.071 2.306 3.282 -20.760 13.734
17.124 14.407 -21.576 -10.740 29.020 -31.759 -58.992 -46.176 19.281 0.228 -1.721 -15.911 14.155
16.689 11.436 -21.655 -10.910 32.165 -23.481 -64.997 -44.599 21.263 -3.286 -16.824 -20.549 8.136
15.965 1.506 -17.075 7.274 28.194 -8.070 -55.616 -40.889 5.836 11.111 -10.133 -14.289 -1.539
13.532 5.951 -9.066 -1.619 28.084 -5.852 -55.691 -33.152 21.429 7.842 -7.354 -7.794 -1.864
12.942 10.227 -3.877 -3.382 18.039 -5.648 -48.353 -25.284 7.797 -3.180 -12.037 -10.255 -12.694
12.615 9.852 2.121 -0.291 15.965 -1.575 -51.682 -19.189 13.583 -3.571 -12.698 -13.142 -11.859
12.510 8.432 5.958 3.663 20.693 5.565 -53.260 -28.409 -3.976 -8.881 -14.713 -8.155 4.349
12.577 6.368 4.617 12.713 11.945 1.309 -43.478 -36.784 -3.596 0.160 -23.450 -5.463 4.001
15.544 -0.720 -24.885 27.789 5.728 -16.027 -31.580 -25.369 22.968 14.677 -24.227 10.169 0.865
16.027 -2.979 -32.559 30.615 0.127 -29.791 -26.679 -21.999 21.413 13.696 -9.756 -3.845 -8.713
15.847 -11.194 -33.811 18.858 -3.632 -32.474 -19.216 -14.747 17.697 15.587 -5.693 -11.813 -12.700
15.895 -14.239 -47.023 12.565 -3.150 -36.882 -8.066 -11.788 12.650 24.344 -1.694 -11.677 -5.872
15.730 -11.233 -45.061 13.641 1.674 -28.614 3.986 -4.001 9.292 22.754 -4.014 -19.808 -5.806
15.485 -8.900 -40.736 3.381 -8.146 -21.945 11.324 1.669 5.908 23.238 -6.456 -23.938 -3.119
14.723 -3.507 -36.932 1.693 -6.704 -27.179 8.315 5.849 15.697 26.449 -23.294 -27.745 0.369
13.714 -5.887 -37.845 -11.462 -14.428 -29.247 4.637 9.639 10.614 19.854 -21.018 -20.819 -1.786
13.330 -4.023 -27.012 2.158 -7.811 -29.505 9.404 11.762 8.545 18.424 -13.069 -20.308 0.292
12.846 -7.923 -25.147 -0.723 -8.712 -31.260 2.314 1.645 5.104 24.544 -10.152 -23.718 1.919
11.942 -10.322 -24.902 -6.417 -9.079 -26.512 -8.724 -9.673 -3.882 15.491 -12.348 -20.501 6.497
11.480 -12.479 -18.231 -6.031 1.193 -17.950 -10.328 -3.830 4.968 23.298 -13.903 -32.828 -1.676
11.285 -12.387 -15.901 -8.527 2.230 -19.459 -16.647 -11.038 0.920 27.817 -6.730 -34.517 -3.868
10.563 -9.253 -9.224 -8.931 -4.371 -15.886 -22.887 -18.492 -4.682 19.761 -15.625 -28.463 -1.680
10.242 -8.817 -7.684 -6.801 -10.133 -13.967 -18.049 -16.827 -11.864 14.978 -10.558 -26.246 -2.477
9.795 -9.755 -5.466 -6.299 -16.971 -14.732 -16.810 -15.624 -13.277 0.158 -10.000 -10.091 -0.344
9.531 -13.407 -7.326 -8.708 -20.425 -18.926 -20.297 -12.706 -10.304 -6.257 -6.390 0.199 -0.552
9.435 -14.118 -2.673 -7.188 -10.426 -15.245 -24.331 -10.294 -2.477 2.644 1.557 0.421 1.860
9.421 -14.096 -3.534 -6.531 -8.381 -12.097 -24.497 -14.138 0.305 4.885 -1.596 -8.567 -6.840
9.519 -15.267 -4.306 -11.523 -8.575 -4.115 -20.409 -9.720 1.559 7.117 -2.467 -4.491 -11.021
9.466 -17.856 -7.987 -14.726 -9.564 -4.269 -13.202 3.165 -3.800 3.514 0.861 -4.616 -18.843
9.428 -18.537 -5.685 -12.346 -6.774 -4.739 -12.759 9.314 -3.769 6.635 2.326 1.432 -8.381
9.330 -20.544 -3.177 -9.331 -4.645 -0.893 -12.510 1.845 -12.819 -7.247 -10.206 -8.343 -3.996
9.354 -18.656 -0.143 -7.182 -1.555 -2.839 -11.847 2.555 -4.265 -4.647 -16.096 -9.461 -2.298
9.268 -19.390 1.995 -7.994 -1.326 -5.287 -8.306 4.698 -2.837 -9.810 -14.654 -11.190 3.342
9.009 -19.789 -0.337 -15.398 -6.285 -9.558 -5.371 7.961 7.032 -7.121 -14.304 -8.251 -1.472
EOF
)"

diff <(echo -e "${TEST}") <(../../bin/fe test/0a2b400e_nohash_0.wav)

TEST="$(cat <<-EOF
5.229 -20.445 -6.385 -9.937 -4.872 -7.378 -11.950 -5.500 -15.188 -18.491 -9.606 3.099 -0.277
5.151 -21.236 -6.004 -7.144 -5.126 -6.685 -12.692 -12.229 -17.380 -21.030 -9.024 3.718 -0.435
5.160 -19.604 -2.527 -5.837 -6.417 -7.574 -8.420 -14.154 -12.875 -15.395 -10.099 0.741 0.617
5.028 -21.510 -5.417 -6.576 -10.632 -14.569 -17.391 -18.421 -11.987 -13.525 -13.434 -8.748 -6.057
4.805 -19.309 -6.832 -6.783 -10.326 -12.434 -15.319 -12.930 -10.419 -11.443 -10.945 -4.512 -6.732
4.878 -21.046 -10.961 -8.951 -9.966 -10.812 -10.351 -12.466 -7.717 -9.144 -9.765 -3.183 -7.301
5.040 -19.560 -4.065 -1.721 2.878 0.153 -2.787 -1.829 -8.490 -4.498 -5.494 0.006 -1.437
6.608 -25.727 0.204 3.323 -14.433 14.233 -10.858 -4.418 -3.698 -19.840 6.747 -5.451 -2.884
13.031 -42.000 5.675 6.306 -50.281 41.596 -49.194 1.611 -0.672 -48.721 38.512 -26.339 2.994
13.056 -39.982 5.557 5.419 -48.449 42.926 -51.678 2.025 4.106 -43.580 38.466 -29.787 -3.365
10.261 -19.308 -1.622 13.556 -27.779 29.316 -23.041 7.226 4.098 -16.333 18.184 -14.867 5.285
8.707 -30.914 1.647 -0.815 -25.673 21.349 -26.769 3.101 -2.170 -32.388 12.615 -21.320 -5.949
7.007 -25.293 0.001 -1.813 -13.072 10.908 -22.048 -0.828 -4.920 -22.168 4.972 -18.249 -5.082
6.195 -25.619 -2.873 -7.722 -9.673 -2.928 -21.921 -11.660 -5.315 -22.893 -9.220 -17.869 -9.482
9.854 -27.245 9.555 -14.771 3.594 -15.788 -4.571 -26.586 7.317 -30.483 3.706 -15.758 10.275
9.883 -28.715 7.876 -14.289 4.323 -16.708 0.118 -23.474 4.753 -32.508 10.804 -6.681 17.891
7.097 -25.981 3.494 -13.186 -5.318 -13.955 -15.051 -20.258 -9.631 -22.084 5.577 -3.257 9.131
6.126 -23.280 0.317 -10.897 -11.904 -17.046 -28.993 -16.127 -14.745 -13.481 1.039 -8.567 -0.585
6.171 -23.809 0.316 -10.913 -10.461 -11.159 -21.909 -9.472 -10.586 -6.525 0.767 -7.530 1.195
6.046 -22.766 -0.832 -8.760 -9.970 -3.437 -17.186 -7.391 -0.351 0.057 7.512 5.837 -12.280
5.866 -21.510 -3.382 -9.760 -10.947 -0.101 -14.067 -9.722 -5.807 -4.328 1.824 5.350 -17.374
5.539 -18.549 -3.161 -8.294 -10.635 -1.038 -9.011 -17.939 -7.135 -10.717 -2.432 -2.290 -14.421
5.340 -17.546 -3.016 -6.645 -8.217 -8.892 -14.485 -12.331 -6.827 -8.777 -5.262 -5.183 -9.730
5.338 -19.409 -6.894 -9.482 -10.837 -15.754 -19.162 -13.900 -17.138 -8.716 -6.581 -0.597 -5.283
5.123 -18.947 -7.414 -14.690 -9.708 -14.615 -20.479 -12.654 -18.597 -13.812 -10.136 -2.374 -0.625
4.907 -18.389 -5.165 -11.424 -7.543 -9.406 -20.714 -15.421 -16.484 -16.653 -11.981 -3.934 1.599
5.266 -18.266 -1.003 -8.120 -9.091 -6.398 -16.994 -8.115 -15.915 -13.577 -13.041 -0.456 -0.456
5.432 -17.504 1.055 -2.732 -2.030 0.449 -10.330 -7.421 -13.875 -8.394 -8.350 -0.312 0.593
5.217 -16.015 1.974 -1.738 -2.989 -1.620 -11.266 -16.464 -19.432 -15.333 -11.371 -7.939 -9.436
5.830 -16.891 5.262 0.457 -0.748 6.416 -11.618 -0.852 -18.614 -3.435 -4.934 -12.885 -3.156
5.957 -16.185 7.272 1.098 -1.864 5.862 -8.314 1.716 -23.511 -12.001 -14.036 -14.049 -2.099
13.050 -16.932 5.866 -18.534 10.040 -17.069 -10.047 4.511 -16.097 8.691 -21.638 -4.126 -7.385
19.400 -36.911 11.864 21.601 -13.032 -25.995 -45.104 -6.851 6.330 4.979 5.616 -10.791 8.750
19.929 -36.725 -6.411 -6.128 -32.793 -26.113 -28.712 -10.538 2.110 1.855 4.991 -6.851 5.375
19.784 -30.389 0.792 1.028 -22.780 -14.293 -16.156 -2.765 1.802 0.398 4.645 -7.631 1.343
19.215 -34.205 -14.527 -4.114 -29.649 -22.482 -14.385 3.000 2.061 3.794 1.321 -0.738 -14.924
19.476 -21.693 -3.190 20.701 -23.600 -26.855 -3.035 22.122 -6.505 -5.945 -5.536 -18.310 -9.577
19.653 -11.511 -11.742 9.846 -32.606 -23.257 -5.371 22.269 -4.404 -12.757 -13.205 -31.304 -6.485
20.479 -7.769 -18.116 9.933 -29.220 -3.482 -6.683 12.016 5.952 -13.546 0.041 -20.146 -5.795
21.041 -3.647 -20.511 9.477 -42.022 -10.572 -9.836 20.590 21.164 -16.289 -1.344 -9.725 -6.058
21.331 -3.253 -21.131 9.188 -44.375 -15.037 -12.500 20.089 22.538 -17.555 -5.586 -12.765 -9.262
21.309 -3.972 -26.744 10.416 -48.636 -19.795 -12.945 21.034 20.527 -23.316 -16.584 -15.573 -17.463
21.308 -5.730 -31.089 14.353 -47.531 -15.882 -12.052 20.620 21.002 -29.497 -24.607 -16.106 -19.130
21.191 -7.369 -25.835 12.244 -39.292 -22.789 0.101 18.754 25.602 -17.153 -16.591 -4.051 -7.387
20.743 -3.203 -31.149 10.349 -42.720 -21.018 1.832 15.765 12.223 -18.452 -20.088 -11.022 -11.512
20.550 -0.957 -30.735 15.533 -47.688 -18.217 -6.111 22.595 8.357 -17.983 -21.094 -10.737 -2.519
20.608 -7.144 -30.447 12.535 -48.647 -19.316 -14.168 21.993 8.754 -32.124 -32.727 -17.678 -9.768
21.044 -8.870 -34.202 20.324 -43.352 -13.595 -16.970 18.795 16.855 -29.432 -28.521 -18.385 -3.658
21.278 -9.614 -37.954 22.240 -39.934 -4.189 -14.061 20.719 19.248 -22.834 -22.132 -15.808 -3.770
20.920 -12.220 -39.131 15.263 -35.342 -2.184 -16.337 13.923 21.703 -22.859 -20.071 -15.511 -2.120
20.288 -5.525 -40.263 18.531 -40.302 6.688 -25.457 13.143 23.298 -24.950 -13.599 -18.002 0.249
19.746 -6.158 -27.113 11.511 -34.893 0.168 -17.151 13.206 20.990 -16.895 -13.473 -17.744 1.159
19.564 -3.999 -24.548 8.342 -40.414 -0.833 -24.712 20.652 28.974 -22.115 -9.393 -16.603 5.263
18.971 -1.711 -25.445 7.457 -45.855 3.760 -38.253 23.493 24.055 -26.760 -12.632 -26.032 1.456
18.096 -0.451 -21.932 11.390 -46.111 3.201 -45.699 27.695 21.173 -26.462 -14.378 -24.965 -5.091
16.508 -2.615 -18.878 10.377 -29.977 0.625 -27.132 20.883 7.114 -22.698 -9.562 -15.338 14.957
15.554 -3.932 -26.467 2.270 -29.530 -4.574 -17.102 5.439 16.683 -34.475 -21.304 -21.873 2.494
15.152 -4.286 -26.163 3.420 -30.331 -13.467 -12.854 2.374 16.407 -39.045 -19.823 -19.254 1.285
14.481 -1.869 -25.714 12.057 -26.937 4.026 -3.339 18.379 29.706 -18.299 -10.315 -11.641 -2.262
13.943 -7.421 -27.831 17.294 -24.335 -1.308 -19.671 3.331 14.432 -22.317 -9.135 -9.620 4.866
13.225 -5.803 -30.153 14.769 -25.131 -10.234 -13.100 -1.442 11.516 -27.514 -14.258 -2.659 3.401
15.505 -15.769 -12.286 -9.922 -36.329 11.467 -28.649 13.958 5.244 -19.023 -1.841 -4.723 9.599
17.966 -28.146 -5.894 -18.762 -51.764 6.772 -40.186 6.526 16.218 -6.953 -7.154 12.887 16.061
18.813 -29.393 5.356 -11.563 -42.587 13.028 -27.188 6.299 16.670 -2.404 -8.593 4.250 16.983
19.102 -39.377 8.936 3.987 -24.646 13.549 -23.249 5.438 13.317 -5.576 -18.004 -6.492 11.491
18.723 -52.311 0.181 1.086 -26.366 2.769 -20.910 18.081 31.126 -8.958 -39.828 0.406 35.967
17.872 -44.260 -0.021 11.179 -5.962 13.789 -17.257 5.623 16.875 -9.321 -29.130 -1.594 31.008
16.759 -36.814 -0.630 9.212 -6.524 14.613 -21.530 3.843 9.565 2.188 -17.623 -5.377 9.849
15.605 -38.707 0.608 16.328 -12.567 7.609 -16.527 11.101 2.586 -9.512 -15.483 -0.330 5.520
14.203 -35.914 -3.035 15.856 -13.045 3.040 -24.609 5.429 5.914 -4.347 -18.564 5.605 -1.505
13.180 -33.974 -7.684 6.923 -15.494 3.510 -36.728 12.769 6.464 -7.388 -28.673 1.802 -4.185
12.537 -32.509 -5.138 9.086 -18.494 10.537 -30.939 10.862 7.305 -4.912 -16.133 -4.814 -2.225
11.683 -27.080 -4.409 5.377 -23.197 6.214 -30.164 5.026 0.492 -20.220 -6.016 -5.925 -7.865
10.605 -20.350 -2.327 4.535 -22.877 3.775 -25.712 -2.421 -3.593 -19.246 2.049 -9.931 -7.933
9.634 -17.105 -4.988 1.778 -20.078 -2.942 -25.989 -4.293 -4.855 -13.258 -3.223 -10.294 -4.137
9.160 -19.052 -9.261 -2.773 -19.317 -8.745 -30.325 -9.651 -16.244 -25.906 -4.583 -14.673 -12.025
8.674 -17.072 -7.330 1.876 -6.552 -0.586 -16.475 3.577 -3.119 -18.127 -7.216 -7.289 -10.143
8.333 -16.712 -10.016 -2.877 -9.366 -3.237 -17.434 -5.193 -9.678 -20.652 -14.485 -7.102 -13.734
8.029 -15.620 -10.361 -4.441 -9.293 -3.428 -17.472 -5.071 -11.515 -29.042 -21.289 -11.312 -12.561
7.818 -15.357 -8.513 -4.442 -6.621 -3.338 -20.128 -10.614 -15.758 -33.867 -27.171 -9.694 -9.181
7.715 -15.320 -6.608 -5.955 0.323 -7.573 -19.426 -9.894 -5.376 -10.926 -15.866 -8.832 -7.450
7.624 -17.890 -10.592 -10.241 -2.176 -9.066 -7.800 -6.559 -7.477 -10.546 -14.967 -17.924 -15.925
7.510 -15.863 -11.353 -9.326 -5.988 -12.270 -0.157 -0.020 -6.114 -7.452 0.157 -13.912 -8.433
7.608 -14.737 -13.790 -7.015 -10.521 -19.681 -7.734 -7.818 -17.637 -11.722 7.575 -11.525 -2.639
7.690 -11.729 -13.667 -6.518 -8.690 -16.909 -6.430 0.318 -15.803 -13.556 3.214 -12.958 -5.984
7.784 -10.314 -13.365 -3.791 -2.952 -9.990 -5.570 1.671 -12.549 -12.185 -0.144 -10.739 -5.411
7.767 -10.779 -13.280 -5.540 -5.930 -15.596 -9.474 -0.823 -11.376 -20.153 -9.893 -20.036 -11.491
7.607 -9.392 -9.543 -4.645 -9.045 -20.279 -13.618 1.867 -7.941 -19.693 -12.777 -23.037 -15.015
7.291 -9.990 -7.177 -6.355 -9.288 -21.857 -17.449 3.705 -4.963 -20.292 -13.466 -18.451 -9.807
7.113 -12.930 -7.242 -7.714 -12.345 -24.089 -21.668 2.511 -3.249 -10.032 -2.013 -18.029 -15.637
6.993 -13.633 -5.912 -5.698 -8.215 -18.995 -16.706 2.572 3.602 -4.272 4.202 -9.433 -17.366
6.939 -13.439 -5.078 -7.497 -9.237 -13.448 -11.633 6.734 7.892 1.965 8.921 -2.673 -7.463
6.856 -13.259 -5.075 -11.471 -9.948 -9.539 -12.398 2.414 9.365 -2.945 4.904 -0.641 -4.582
6.860 -13.468 -4.140 -16.069 -10.200 -9.505 -15.260 -3.886 7.602 -6.314 0.311 -9.977 -12.301
6.759 -13.016 -1.027 -14.025 -9.352 -7.253 -10.797 -3.642 2.180 -10.375 -0.235 -9.723 -15.965
6.789 -14.338 -0.094 -14.692 -11.631 -3.970 -12.623 -3.508 -1.365 -10.605 -2.608 -8.081 -14.861
6.743 -14.810 -3.455 -13.761 -10.745 -2.314 -11.086 -2.963 -6.973 -11.016 -6.994 -4.735 -6.613
6.661 -16.400 -5.932 -16.423 -11.088 -7.735 -18.368 -11.046 -12.671 -13.696 -11.458 -17.228 -14.795
6.331 -13.547 -5.196 -15.827 -8.403 -6.138 -20.461 -10.371 -11.156 -12.551 -5.373 -5.867 -6.082
EOF
)"

diff <(echo -e "${TEST}") <(../../bin/fe < test/0ea9c8ce_nohash_0.wav)

TEST="$(cat <<-EOF
15.815 -14.073 -49.120 3.451 -39.852 -21.017 -16.461 2.841 -14.055 13.243 -12.183 8.077 -15.056
12.776 -4.808 -26.290 0.764 -11.161 10.200 -4.987 11.338 -19.472 0.325 -15.589 15.361 -14.898
11.386 -5.221 -19.280 -3.928 -6.338 7.456 -2.363 1.664 -15.084 3.800 -13.283 5.858 -8.108
10.557 -8.511 -19.953 -12.928 -8.283 12.239 -10.359 -11.964 -24.876 -6.474 -25.261 5.024 -5.986
9.863 -11.096 -14.882 -13.548 -4.427 20.934 1.599 13.838 -10.959 5.597 -17.414 2.980 -0.836
9.414 -11.442 -11.302 -12.639 -7.906 14.083 -1.759 19.771 -6.453 8.302 -19.918 1.529 -4.992
8.981 -14.797 -11.009 -15.942 -15.693 4.085 -8.375 11.711 -13.831 0.062 -16.457 0.456 -7.570
8.877 -11.221 -7.001 -11.076 -11.751 10.046 0.849 23.149 1.201 9.401 -6.955 5.461 -4.624
8.991 -10.552 -4.376 -13.350 -16.667 10.335 -0.943 22.577 4.654 4.638 -15.304 -0.851 -1.617
8.813 -11.303 -3.136 -13.926 -19.643 7.440 -6.272 17.031 0.988 2.235 -20.366 0.775 8.370
8.518 -14.165 -4.918 -15.979 -22.484 -0.678 -8.375 11.373 -13.604 -1.405 -20.211 -1.113 5.033
8.476 -14.284 -4.470 -15.981 -24.422 -2.441 -4.483 9.711 -16.983 3.895 -19.837 -2.896 -0.090
8.588 -8.475 0.446 -12.745 -23.025 -6.915 -5.784 9.672 -16.214 2.842 -14.266 6.010 1.700
8.435 -12.487 -10.606 -23.800 -34.518 -21.906 -23.823 3.734 -9.519 6.010 -4.372 16.159 7.444
8.055 -10.637 -7.841 -17.349 -29.603 -23.849 -25.088 4.732 -5.394 12.357 2.029 18.007 12.711
7.142 -18.487 -13.441 -14.615 -13.531 -6.135 -12.478 17.587 -0.059 4.901 -4.042 15.537 6.442
7.271 -20.491 -12.766 -9.388 -9.352 2.089 -6.666 11.430 -11.446 -8.699 -18.230 11.158 0.836
7.817 -17.234 -11.400 -9.832 -9.948 8.628 -4.565 14.378 -7.386 -1.325 -6.600 8.166 6.198
8.113 -16.926 -7.501 -8.644 -10.796 17.375 0.421 15.619 -4.912 -0.219 -5.783 15.538 15.995
8.201 -16.002 -7.081 -6.182 -11.443 19.595 -1.774 16.548 -5.394 -2.840 -9.952 14.126 10.453
7.976 -19.309 -7.613 -8.700 -12.381 16.299 -3.519 14.134 -2.880 -3.220 -9.890 9.173 2.189
7.862 -24.037 -9.199 -13.855 -13.175 12.511 0.515 15.758 -4.330 -2.653 -12.953 6.163 3.684
7.982 -21.841 -4.941 -5.987 -10.132 14.220 8.006 9.191 -5.534 2.089 -16.300 5.960 -0.465
8.108 -22.661 -6.612 -6.362 -10.225 14.446 8.822 7.081 -5.871 5.893 -5.176 13.726 -0.700
8.067 -23.515 -9.242 -4.114 -8.831 10.312 2.364 4.987 -7.826 -2.513 -0.854 19.645 4.813
8.048 -21.622 -8.486 -6.053 -7.459 3.597 -4.608 13.796 -1.590 -3.690 -8.376 14.576 2.357
8.350 -18.999 -4.120 0.449 1.584 8.765 -0.844 18.074 0.370 2.618 -8.328 17.117 -4.290
8.371 -19.036 -4.205 0.342 2.241 9.402 -2.343 21.560 1.534 3.857 -11.992 13.613 -6.727
8.169 -20.927 -7.486 -3.239 3.612 10.255 4.342 11.480 -6.226 1.288 -9.251 18.175 -5.482
7.928 -25.915 -15.765 -14.188 -11.759 -2.684 -3.192 4.260 -9.249 13.070 0.098 19.693 5.323
7.912 -25.333 -12.309 -8.656 -10.248 1.574 -2.823 -2.011 -9.476 6.807 -3.484 23.244 5.927
7.989 -25.805 -18.393 -15.885 -19.552 1.948 -1.961 2.960 -15.793 -10.312 -27.617 7.624 11.819
8.176 -24.724 -21.411 -18.596 -20.727 -1.114 -2.261 2.133 -17.881 -8.065 -20.065 4.716 9.572
8.097 -23.047 -18.961 -18.184 -18.957 0.437 4.112 4.040 -15.593 -2.768 -17.561 -0.690 2.439
8.181 -24.727 -16.920 -16.974 -12.631 9.472 11.583 7.037 -7.691 3.702 -17.057 0.010 -6.865
8.270 -23.229 -14.696 -14.729 -8.119 10.984 10.845 7.389 -5.123 3.489 -12.748 1.994 -13.236
8.346 -18.664 -9.919 -11.317 -4.505 0.878 -1.005 2.965 -12.099 -2.626 -12.195 2.795 -7.837
8.206 -16.593 -8.780 -9.595 -6.854 -0.888 -3.812 -1.375 -16.110 -4.300 -14.215 5.163 -4.663
8.187 -16.052 -8.429 -8.685 -12.592 1.499 -5.715 -6.021 -18.023 5.213 -11.096 10.073 -6.533
8.276 -17.023 -9.016 -10.800 -9.733 8.035 -2.985 -4.880 -15.143 7.623 -6.434 11.598 -9.774
8.392 -20.585 -14.877 -19.781 -11.443 5.312 -7.895 -9.279 -21.771 0.987 -3.755 4.612 -8.357
8.551 -15.958 -12.380 -16.403 -2.244 17.047 0.701 -2.543 -22.054 -2.226 1.119 6.470 -8.144
9.975 -25.358 -10.142 -25.129 -10.686 22.544 -5.181 15.541 -24.014 -2.249 11.521 6.213 -12.409
12.223 -36.410 -5.284 -37.707 -20.303 24.918 -21.311 30.745 -35.508 0.070 11.114 8.853 -7.176
13.535 -36.031 13.086 -34.637 -6.280 24.702 -9.825 32.954 -29.066 -0.145 1.805 -3.669 -8.532
13.781 -34.197 18.280 -28.346 -4.429 21.009 -15.541 26.111 -23.771 1.499 0.957 -3.778 -6.444
13.414 -39.897 14.691 -28.702 -7.532 14.748 -12.915 31.195 -18.493 -2.728 1.504 -1.989 -5.029
12.786 -32.831 13.133 -14.663 0.287 21.342 -18.015 12.406 -16.158 -4.392 -6.610 4.445 -7.464
13.086 -40.459 15.457 -23.517 -7.351 27.049 -23.492 14.805 -19.908 -10.813 -7.420 1.499 -13.553
13.341 -38.149 20.088 -18.164 -4.384 23.020 -12.694 22.286 -16.674 -10.693 2.414 3.352 -7.922
13.891 -36.421 14.377 -10.421 4.444 19.919 -9.745 15.286 -13.783 -11.330 -3.874 5.306 -1.685
15.102 -36.606 15.603 -22.321 -17.324 7.177 -6.042 36.630 -5.250 -13.694 -2.166 -17.798 0.374
16.439 -40.820 20.849 -17.471 -16.483 5.678 -8.978 42.130 -2.474 -25.453 -5.920 -18.558 9.602
16.973 -38.820 18.699 -5.232 -17.703 -1.479 -13.061 40.470 0.397 -17.769 1.206 -14.251 -1.687
17.173 -19.570 21.924 6.748 -25.010 -25.716 -32.374 33.360 -21.525 -31.205 9.449 -5.337 -7.593
17.406 -9.283 10.140 7.212 -31.291 -30.656 -36.687 26.009 -31.897 -19.138 12.182 -6.200 -10.690
18.421 -5.885 -6.415 10.978 -27.742 -38.251 -22.479 27.392 -27.119 -18.732 6.379 -2.507 -14.321
19.098 -2.625 -11.800 13.704 -27.253 -43.735 -9.457 32.380 -30.701 -14.665 10.067 -5.902 -25.213
19.641 0.394 -19.895 18.706 -27.829 -43.916 3.044 33.308 -24.703 -9.466 11.669 -9.790 -20.201
19.757 1.172 -22.594 13.481 -31.631 -43.989 9.236 28.969 -21.960 -7.162 19.812 -14.033 -20.331
19.648 5.454 -28.129 14.141 -32.691 -41.684 3.279 25.020 -13.852 -4.175 14.692 -11.760 -16.202
19.448 11.613 -27.465 9.156 -28.093 -38.997 0.779 26.464 -4.651 -8.338 13.313 -8.780 -23.113
19.373 9.579 -23.790 -4.407 -19.708 -37.733 -4.700 28.268 4.404 -10.748 15.761 -9.648 -18.321
19.488 12.715 -25.607 -6.052 -19.469 -34.880 -20.589 28.517 9.231 -10.844 9.590 -7.476 -7.219
19.686 17.649 -27.304 -8.059 -19.265 -22.938 -28.393 21.752 19.660 -2.754 -2.098 -10.334 -1.765
19.724 16.503 -22.934 -16.899 -13.198 -20.681 -30.600 18.112 23.234 3.600 5.518 -8.166 -5.994
19.878 17.884 -16.742 -16.765 -12.272 -19.064 -29.693 8.196 18.771 13.626 8.681 -13.327 -3.326
19.967 33.317 -19.215 -18.148 -8.994 -8.856 -39.211 14.432 13.921 28.896 8.186 -18.961 -0.313
19.936 24.104 -15.417 -21.061 -10.178 -21.462 -33.645 -7.841 17.735 15.407 6.528 -3.065 -6.761
19.817 29.992 -15.044 -24.290 -3.559 -14.815 -36.484 -12.557 9.488 14.447 6.203 -0.849 -5.088
19.658 36.162 -16.425 -28.422 1.658 -7.467 -31.730 -13.000 2.381 13.433 8.628 9.912 5.222
19.580 32.053 -17.941 -30.583 -4.757 -8.136 -33.661 -17.009 3.769 10.304 0.541 1.275 8.660
19.429 23.982 -18.821 -27.474 -6.497 -7.763 -23.326 -10.069 10.942 12.894 4.878 5.689 8.059
18.959 35.770 -29.385 -37.179 2.554 -12.511 -41.219 -5.601 6.030 -0.902 -3.966 14.414 6.367
18.593 33.077 -27.639 -26.804 2.678 -7.170 -26.522 2.158 9.679 -5.944 -7.532 4.637 0.887
18.670 18.713 -24.210 -31.407 -7.989 -11.996 -19.005 2.309 12.383 -4.724 -7.523 2.399 -5.078
19.134 28.284 -21.853 -29.092 -6.199 -12.042 -17.760 6.945 10.987 1.046 2.444 -0.876 -12.829
19.528 24.724 -17.952 -26.959 -13.034 -13.194 -12.716 3.644 12.271 9.228 -0.315 -12.686 -10.866
19.691 27.687 -17.788 -28.247 -12.404 -14.038 -10.828 11.166 16.508 7.396 -2.572 -10.276 -7.843
19.699 38.406 -21.777 -33.308 -4.101 -15.804 -15.725 24.677 11.384 8.043 -3.909 -11.103 -8.374
19.583 29.571 -15.951 -32.173 -9.807 -12.093 -10.826 16.002 19.622 4.795 -9.205 -9.509 -6.785
19.391 21.329 -15.435 -27.703 -16.242 -14.766 -5.799 14.162 17.761 4.093 -11.008 -12.847 -4.447
19.219 23.481 -16.463 -28.252 -17.432 -14.154 -4.876 13.392 16.807 2.299 -12.032 -15.945 -6.882
19.093 21.626 -15.515 -30.190 -18.478 -13.074 -4.487 13.307 18.082 0.310 -13.344 -14.553 -5.567
18.962 18.496 -14.073 -29.483 -23.046 -10.111 -0.312 9.411 16.492 8.239 -12.434 -15.616 -1.267
18.762 27.275 -14.414 -32.333 -18.648 -7.439 -0.988 9.172 11.288 13.040 -5.359 -17.275 -3.575
18.441 32.342 -15.405 -36.588 -15.871 -9.035 -5.192 10.640 0.775 12.016 0.175 -15.773 -10.606
18.157 30.180 -12.543 -37.205 -22.320 -9.576 -1.165 5.857 -8.720 12.166 4.551 -13.527 -17.920
17.850 25.009 -12.721 -38.054 -25.811 -12.577 -6.384 -9.194 -7.406 6.583 -1.850 -15.528 -21.242
17.574 26.898 -9.727 -34.209 -22.428 -4.684 -6.129 -8.142 -7.779 17.703 3.501 -13.296 -17.907
17.255 29.115 -7.923 -39.113 -24.001 -4.558 -7.932 -5.017 -29.109 25.121 12.022 -20.354 -26.070
16.759 23.999 -11.024 -33.915 -23.849 -12.048 -11.379 -11.669 -22.725 13.541 -0.505 -20.319 -25.979
16.114 29.973 -5.170 -28.023 -19.116 2.041 -2.569 7.579 -32.124 22.722 0.499 -15.143 -18.148
15.482 26.885 -3.723 -27.243 -12.803 3.560 1.190 5.698 -43.927 8.194 -7.064 -20.146 -12.425
14.930 22.723 4.522 -26.837 -24.281 8.615 7.966 2.024 -49.497 5.847 -5.868 -16.886 -11.026
14.288 20.567 7.596 -24.475 -17.407 7.050 8.182 13.904 -40.975 2.010 -8.840 -10.148 -1.493
13.409 15.421 7.532 -22.989 -23.504 5.229 9.710 6.078 -48.575 11.150 -8.296 -15.392 -2.472
12.656 8.076 -0.268 -21.408 -22.831 3.961 5.810 6.058 -42.513 20.523 -14.807 -14.314 -8.177
12.134 4.856 -3.598 -20.679 -20.566 5.327 5.680 7.222 -44.228 27.941 -9.667 -0.910 3.015
EOF
)"

diff <(echo -e "${TEST}") <(../../bin/fe < test/08ab8082_nohash_0.wav)

echo "Features extractor build OK!"